@model Yuzu.Web.Pages.SettingsModel
@{
    var sectionId = ViewData["SectionId"] as string ?? string.Empty;
    var sectionTitle = ViewData["SectionTitle"] as string ?? "Section Title";
    var containerCols = ViewData["ContainerColumns"] as string ?? "row-cols-1 row-cols-sm-2";
    var showViewport = ViewData["ShowViewport"] as bool? ?? true;
    var preLoaded = ViewData["PreLoaded"] as bool? ?? false;
    var actionButton = ViewData["ActionButton"] as Dictionary<string, string>;
}

<!-- Section Header -->
<div class="d-flex align-items-center justify-content-between pt-xl-1 mb-3 pb-3">
    <h1 class="h2 mb-0 mt-4">@sectionTitle</h1>
    @if (actionButton != null)
    {
        <button type="button" class="btn btn-primary px-3 px-sm-4" 
                id="@(actionButton.GetValueOrDefault("id", $"{sectionId}-action-button"))"
                @(actionButton.ContainsKey("onclick") ? $"onclick=\"{actionButton["onclick"]}\"" : "")
                @(actionButton.ContainsKey("data-bs-toggle") ? $"data-bs-toggle={actionButton["data-bs-toggle"]}" : "")
                @(actionButton.ContainsKey("data-bs-target") ? $"data-bs-target={actionButton["data-bs-target"]}" : "")
                @* Never disable the main action button *@>
            <i class="@(actionButton.GetValueOrDefault("icon", "bx bx-plus-circle")) fs-xl me-sm-2"></i>
            <span class="d-none d-sm-inline">@(actionButton.GetValueOrDefault("text", "Action"))</span>
            @if (!Model.IsSubscribed && actionButton.GetValueOrDefault("requiresSubscription", "false") == "true")
            {
                <i class="fa-solid fa-rectangle-pro fs-lg text-warning ms-2"></i>
            }
        </button>
    }
</div>

@if (showViewport)
{
    <!-- Viewport Container with Fade Overlays -->
    <div class="viewport-container-wrapper">
        <!-- Top fade overlay -->
        <div class="fade-overlay fade-top"></div>
        
        <!-- Scrollable container -->
        <div class="viewport-container" id="@(sectionId)-viewport-container">
            <div id="@(sectionId)-container" class="row @containerCols gx-3 gy-3" data-loaded="@(preLoaded ? "true" : "false")">
                @if (!preLoaded)
                {
                    <!-- Loading placeholder -->
                    <div class="col loading-placeholder">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body d-flex align-items-center justify-content-center">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                }
                else
                {
                    <!-- Empty placeholder - items will be loaded in the background -->
                    <div class="col-12 py-4 text-center d-none">
                        <!-- This is intentionally empty and hidden, content will be populated by JavaScript -->
                    </div>
                }
                <!-- Items will be populated here via JavaScript -->
            </div>
        </div>
        
        <!-- Bottom fade overlay -->
        <div class="fade-overlay fade-bottom"></div>
    </div>
}

<!-- Additional content is provided by the calling partial -->